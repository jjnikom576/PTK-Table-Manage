<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ระบบจัดตารางสอนสำหรับโรงเรียนมัธยมศึกษา รองรับการจัดการแบบหลายปีการศึกษา">
    <meta name="keywords" content="ตารางสอน, โรงเรียน, มัธยมศึกษา, จัดตาราง, ครู, นักเรียน">
    <title>ระบบจัดตารางสอน - โรงเรียนมัธยมศึกษา</title>
    
    <!-- CSS Stylesheets -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <!-- Global Context Bar -->
    <header class="global-context">
        <div class="container">
            <div class="context-controls">
                <div class="context-selector">
                    <label for="year-selector">📅 ปีการศึกษา:</label>
                    <select id="year-selector" name="academic-year" aria-label="เลือกปีการศึกษา">
                        <option value="">กำลังโหลด...</option>
                    </select>
                </div>
                
                <div class="context-divider">|</div>
                
                <div class="context-selector">
                    <label for="semester-selector">ภาคเรียน:</label>
                    <select id="semester-selector" name="semester" aria-label="เลือกภาคเรียน">
                        <option value="">กำลังโหลด...</option>
                    </select>
                </div>
                
                <div class="context-action">
                    <button type="button" id="context-apply-btn" class="btn btn--primary btn--sm">
                        OK
                    </button>
                </div>
                
                <div class="context-status">
                    <span id="context-loading" class="loading-indicator hidden" aria-live="polite">
                        🔄 กำลังโหลด...
                    </span>
                </div>
            </div>
            
           
        </div>
    </header>

    <!-- Main Navigation -->
    <nav class="main-navigation" role="navigation" aria-label="เมนูหลัก">
        <div class="container">
            <div class="nav-brand">
                <h1>ระบบจัดตารางสอน</h1>
            </div>
            
            <ul class="nav-menu" role="menubar">
                <li class="nav-item" role="none">
                    <a href="#student-schedule" class="nav-link" role="menuitem" data-page="student">
                        📚 ตารางเรียน
                    </a>
                </li>
                <li class="nav-item" role="none">
                    <a href="#teacher-schedule" class="nav-link" role="menuitem" data-page="teacher">
                        👨‍🏫 ตารางสอน
                    </a>
                </li>
                <li class="nav-item" role="none">
                    <a href="#substitution" class="nav-link" role="menuitem" data-page="substitution">
                        🔄 ตารางสอนแทน
                    </a>
                </li>
                <li class="nav-item" role="none">
                    <a href="#admin" class="nav-link" role="menuitem" data-page="admin">
                        ⚙️ จัดการระบบ
                    </a>
                </li>
            </ul>
            
            <button class="mobile-menu-toggle" aria-label="เปิด/ปิดเมนู" aria-expanded="false">
                <span class="hamburger"></span>
            </button>
        </div>
    </nav>

   

    <!-- Main Content Area -->
    <main class="main-content" role="main">
        <div class="container">

            <!-- Student Schedule Page -->
            <section id="page-student" class="page-content hidden" aria-labelledby="student-title">
                <header class="page-header">
                    <h2 id="student-title">📚 ตารางเรียน <span id="current-semester-display"></span></h2>
                    
                    <!-- Sub Navigation for Student Page -->
                    <nav class="sub-navigation" aria-label="เมนูย่อยตารางเรียน">
                        <div class="sub-nav-controls">
                            <div class="class-selector">
                                <label for="class-dropdown">🏫 เลือกห้องเรียน:</label>
                                <select id="class-dropdown" name="class" aria-label="เลือกห้องเรียน">
                                    <option value="">-- เลือกห้องเรียน --</option>
                                </select>
                            </div>
                        </div>
                    </nav>
                </header>
                
                <!-- Export Bar for Student -->
                <div id="export-bar-student" class="export-bar" role="toolbar" aria-label="เครื่องมือส่งออกข้อมูล">
                    <div class="export-label">
                        <span>📤 ส่งออกตาราง:</span>
                    </div>
                    <div class="export-buttons">
                        <button type="button" class="btn btn--outline btn--sm" 
                                data-export-type="csv" data-target="student"
                                aria-label="ส่งออกเป็นไฟล์ CSV">
                            📄 CSV
                        </button>
                        <button type="button" class="btn btn--outline btn--sm" 
                                data-export-type="xlsx" data-target="student"
                                aria-label="ส่งออกเป็นไฟล์ Excel">
                            📊 Excel
                        </button>
                        <button type="button" class="btn btn--outline btn--sm btn--gsheets" 
                                data-export-type="gsheets" data-target="student"
                                aria-label="ส่งออกไป Google Sheets">
                            📋 Google Sheets
                        </button>
                    </div>
                </div>
                
                <!-- Student Schedule Content -->
                <div class="page-body">
                    <div id="student-schedule-header" class="schedule-header hidden">
                        <h3 id="selected-class-title">ตารางเรียน <span id="selected-class-name">ม.1/1</span></h3>
                        <p id="schedule-context" class="schedule-context"></p>
                    </div>
                    
                    <div id="student-schedule-table" class="schedule-container">
                        <!-- Schedule table will be rendered here -->
                    </div>
                    
                    <div id="student-empty-state" class="empty-state">
                        <p>กรุณาเลือกห้องเรียนเพื่อดูตารางเรียน</p>
                    </div>
                    
                    <div id="student-loading" class="loading-state hidden" aria-live="polite">
                        <div class="loading-spinner"></div>
                        <p>กำลังโหลดตารางเรียน...</p>
                    </div>
                    
                    <div id="student-error" class="error-state hidden" role="alert">
                        <p class="error-message">เกิดข้อผิดพลาดในการโหลดข้อมูล</p>
                        <button type="button" class="btn btn--primary" id="student-retry">ลองใหม่</button>
                    </div>
                </div>
            </section>

            <!-- Teacher Schedule Page -->
            <section id="page-teacher" class="page-content hidden" aria-labelledby="teacher-title">
                <header class="page-header">
                    <h2 id="teacher-title">👨‍🏫 ตารางสอน <span id="teacher-semester-display"></span></h2>
                    
                    <!-- Sub Navigation for Teacher Page -->
                    <nav class="sub-navigation" aria-label="เมนูย่อยตารางสอน">
                        <ul class="sub-nav-tabs" role="tablist">
                            <li role="none">
                                <button type="button" class="sub-nav-tab active" role="tab" 
                                        aria-selected="true" data-target="teacher-summary"
                                        id="tab-teacher-summary" aria-controls="teacher-summary">
                                    📊 สรุปภาระงาน
                                </button>
                            </li>
                            <li role="none">
                                <button type="button" class="sub-nav-tab" role="tab" 
                                        aria-selected="false" data-target="teacher-details"
                                        id="tab-teacher-details" aria-controls="teacher-details">
                                    📋 ตารางรายครู
                                </button>
                            </li>
                        </ul>
                    </nav>
                </header>

                <!-- Teacher Summary Tab -->
                <div id="teacher-summary" class="sub-page active" role="tabpanel" 
                     aria-labelledby="tab-teacher-summary">
                    
                    <div id="workload-summary" class="workload-container">
                        <div class="summary-section">
                            <h3>🏆 กลุ่มสาระ (รวมชั่วโมง)</h3>
                            <div id="subject-group-stats" class="stats-grid">
                                <!-- Subject group stats will be rendered here -->
                            </div>
                        </div>
                        
                        <div class="summary-section">
                            <h3>🥇 ครู (รายคน)</h3>
                            <div id="teacher-ranking" class="ranking-list">
                                <!-- Teacher ranking will be rendered here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Teacher Details Tab -->
                <div id="teacher-details" class="sub-page hidden" role="tabpanel" 
                     aria-labelledby="tab-teacher-details">
                    
                    <!-- Export Bar for Teacher (hidden until a teacher is selected) -->
                    <div id="export-bar-teacher" class="export-bar hidden" role="toolbar" aria-label="เครื่องมือส่งออกข้อมูลครู">
                        <div class="export-label">
                            <span>📤 ส่งออกตารางครู:</span>
                        </div>
                        <div class="export-buttons">
                            <button type="button" class="btn btn--outline btn--sm" 
                                    data-export-type="csv" data-target="teacher"
                                    aria-label="ส่งออกตารางครูเป็นไฟล์ CSV">
                                📄 CSV
                            </button>
                            <button type="button" class="btn btn--outline btn--sm" 
                                    data-export-type="xlsx" data-target="teacher"
                                    aria-label="ส่งออกตารางครูเป็นไฟล์ Excel">
                                📊 Excel
                            </button>
                            <button type="button" class="btn btn--outline btn--sm btn--gsheets" 
                                    data-export-type="gsheets" data-target="teacher"
                                    aria-label="ส่งออกตารางครูไป Google Sheets">
                                📋 Google Sheets
                            </button>
                        </div>
                    </div>
                    
                    <!-- Teacher Selection -->
                    <div class="teacher-controls">
                        <div class="teacher-tabs" id="teacher-tabs" role="tablist" aria-label="เลือกครู">
                            <!-- Teacher tabs will be rendered here -->
                        </div>
                    </div>
                    
                    <!-- Teacher Schedule Content -->
                    <div id="teacher-schedule-content" class="teacher-content hidden">
                        <div id="teacher-info" class="teacher-info hidden">
                            <!-- Teacher information will be rendered here -->
                        </div>
                        
                        <div id="teacher-schedule-table" class="schedule-container hidden">
                            <!-- Teacher schedule table will be rendered here -->
                        </div>
                        
                        <div id="teacher-workload" class="workload-details hidden">
                            <!-- Teacher workload details will be rendered here -->
                        </div>
                    </div>
                    
                    <div id="teacher-details-empty" class="empty-state">
                        <p>เลือกครูเพื่อดูตารางสอนและภาระงาน</p>
                    </div>
                </div>
                
                <!-- Teacher Page Loading/Error States -->
                <div id="teacher-loading" class="loading-state hidden" aria-live="polite">
                    <div class="loading-spinner"></div>
                    <p>กำลังโหลดข้อมูลครู...</p>
                </div>
                
                <div id="teacher-error" class="error-state hidden" role="alert">
                    <p class="error-message">เกิดข้อผิดพลาดในการโหลดข้อมูลครู</p>
                    <button type="button" class="btn btn--primary" id="teacher-retry">ลองใหม่</button>
                </div>
            </section>

            <!-- Substitution Page -->
            <section id="page-substitution" class="page-content hidden" aria-labelledby="substitution-title">
                <header class="page-header">
                    <h2 id="substitution-title">🔄 ตารางสอนแทน</h2>
                    
                    <!-- Sub Navigation for Substitution Page -->
                    <nav class="sub-navigation" aria-label="เมนูย่อยตารางสอนแทน">
                        <ul class="sub-nav-tabs" role="tablist">
                            <li role="none">
                                <button type="button" class="sub-nav-tab active" role="tab" 
                                        aria-selected="true" data-target="hall-of-fame"
                                        id="tab-hall-of-fame" aria-controls="hall-of-fame">
                                    🏅 Hall of Fame
                                </button>
                            </li>
                            <li role="none">
                                <button type="button" class="sub-nav-tab" role="tab" 
                                        aria-selected="false" data-target="substitution-schedule"
                                        id="tab-substitution-schedule" aria-controls="substitution-schedule">
                                    📋 ตารางสอนแทน
                                </button>
                            </li>
                        </ul>
                    </nav>
                </header>

                <!-- Hall of Fame Tab -->
                <div id="hall-of-fame" class="sub-page active" role="tabpanel" 
                     aria-labelledby="tab-hall-of-fame">
                    
                    <div class="hall-of-fame-container">
                        <h3>🏅 Hall of Fame - ครูสอนแทน (ภาคเรียนนี้)</h3>
                        <div id="substitute-ranking" class="ranking-podium">
                            <!-- Hall of Fame ranking will be rendered here -->
                        </div>
                        
                        <div id="substitute-stats" class="stats-summary">
                            <!-- Additional substitution statistics -->
                        </div>
                    </div>
                </div>

                <!-- Substitution Schedule Tab -->
                <div id="substitution-schedule" class="sub-page hidden" role="tabpanel" 
                     aria-labelledby="tab-substitution-schedule">
                    
                    <!-- Export Bar for Substitution -->
                    <div id="export-bar-substitution" class="export-bar" role="toolbar" aria-label="เครื่องมือส่งออกข้อมูลสอนแทน">
                        <div class="export-label">
                            <span>📤 ส่งออกตารางสอนแทน:</span>
                        </div>
                        <div class="export-buttons">
                            <button type="button" class="btn btn--outline btn--sm" 
                                    data-export-type="csv" data-target="substitution"
                                    aria-label="ส่งออกตารางสอนแทนเป็นไฟล์ CSV">
                                📄 CSV
                            </button>
                            <button type="button" class="btn btn--outline btn--sm" 
                                    data-export-type="xlsx" data-target="substitution"
                                    aria-label="ส่งออกตารางสอนแทนเป็นไฟล์ Excel">
                                📊 Excel
                            </button>
                            <button type="button" class="btn btn--outline btn--sm btn--gsheets" 
                                    data-export-type="gsheets" data-target="substitution"
                                    aria-label="ส่งออกตารางสอนแทนไป Google Sheets">
                                📋 Google Sheets
                            </button>
                        </div>
                    </div>
                    
                    <!-- Date Picker Controls -->
                    <div class="date-controls">
                        <h3>📅 เลือกวันที่ดูการสอนแทน</h3>
                        <div class="date-picker-toolbar">
                            <button type="button" class="btn btn--ghost" id="btn-today">วันนี้</button>
                            <button type="button" class="btn btn--ghost" id="btn-yesterday">เมื่อวาน</button>
                            <button type="button" class="btn btn--ghost" id="btn-last-week">สัปดาห์ที่แล้ว</button>
                            
                            <div class="date-input-group">
                                <label for="date-picker" class="sr-only">เลือกวันที่</label>
                                <input type="date" id="date-picker" class="date-input" aria-label="เลือกวันที่">
                                <button type="button" class="btn btn--primary" id="btn-load-date">โหลด</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Substitution Content -->
                    <div id="substitution-content" class="substitution-container">
                        <div id="selected-date-info" class="date-info hidden">
                            <h4 id="substitution-date-title">ตารางสอนแทน</h4>
                        </div>
                        
                        <div id="absent-teachers" class="absent-section">
                            <!-- Absent teachers cards will be rendered here -->
                        </div>
                        
                        <div id="substitute-assignments" class="substitute-section">
                            <!-- Substitute assignments will be rendered here -->
                        </div>
                    </div>
                    
                    <div id="substitution-empty" class="empty-state">
                        <p>เลือกวันที่เพื่อดูตารางสอนแทน</p>
                    </div>
                </div>
                
                <!-- Substitution Loading/Error States -->
                <div id="substitution-loading" class="loading-state hidden" aria-live="polite">
                    <div class="loading-spinner"></div>
                    <p>กำลังโหลดข้อมูลสอนแทน...</p>
                </div>
                
                <div id="substitution-error" class="error-state hidden" role="alert">
                    <p class="error-message">เกิดข้อผิดพลาดในการโหลดข้อมูลสอนแทน</p>
                    <button type="button" class="btn btn--primary" id="substitution-retry">ลองใหม่</button>
                </div>
            </section>

            <!-- Admin Page -->
            <section id="page-admin" class="page-content hidden" aria-labelledby="admin-title">
                <header class="page-header">
                    <h2 id="admin-title">⚙️ จัดการระบบ (Admin Only)</h2>
                    
                    <!-- Admin Sub Navigation -->
                    <nav class="sub-navigation" aria-label="เมนูย่อยจัดการระบบ">
                        <ul class="sub-nav-tabs" role="tablist">
                            <li role="none">
                                <button type="button" class="sub-nav-tab active" role="tab" 
                                        aria-selected="true" data-target="admin-data"
                                        id="tab-admin-data" aria-controls="admin-data">
                                    📋 เพิ่มข้อมูล
                                </button>
                            </li>
                            <li role="none">
                                <button type="button" class="sub-nav-tab" role="tab" 
                                        aria-selected="false" data-target="admin-schedule"
                                        id="tab-admin-schedule" aria-controls="admin-schedule">
                                    🤖 สร้างตารางสอน
                                </button>
                            </li>
                            <li role="none">
                                <button type="button" class="sub-nav-tab" role="tab" 
                                        aria-selected="false" data-target="admin-substitute"
                                        id="tab-admin-substitute" aria-controls="admin-substitute">
                                    🔄 จัดการการสอนแทน
                                </button>
                            </li>
                            <li role="none">
                                <button type="button" class="sub-nav-tab" role="tab" 
                                        aria-selected="false" data-target="admin-year"
                                        id="tab-admin-year" aria-controls="admin-year">
                                    📅 จัดการปีการศึกษา
                                </button>
                            </li>
                        </ul>
                    </nav>
                </header>

                <!-- Admin Authentication Check -->
                <div id="admin-auth-check" class="auth-container hidden">
                    <div class="auth-form">
                        <h3>🔐 ยืนยันตัวตนผู้ดูแลระบบ</h3>
                        <form id="admin-login-form">
                            <label for="admin-username">ชื่อผู้ใช้:</label>
                            <input type="text" id="admin-username" name="username" required>
                            
                            <label for="admin-password">รหัสผ่าน:</label>
                            <input type="password" id="admin-password" name="password" required>
                            
                            <button type="submit" class="btn btn--primary">เข้าสู่ระบบ</button>
                        </form>
                    </div>
                </div>

                <!-- Data Management Tab -->
                <div id="admin-data" class="sub-page active admin-section" role="tabpanel" 
                     aria-labelledby="tab-admin-data">
                    
                    <!-- Sub-Sub Navigation for Data Management -->
                    <nav class="data-sub-navigation" aria-label="เมนูย่อยเพิ่มข้อมูล">
                        <ul class="data-sub-nav-tabs" role="tablist">
                            <li role="none">
                                <button type="button" class="data-sub-nav-tab active" role="tab" 
                                        aria-selected="true" data-target="add-teacher"
                                        id="tab-add-teacher" aria-controls="add-teacher">
                                    👨‍🏫 เพิ่มครู
                                </button>
                            </li>
                            <li role="none">
                                <button type="button" class="data-sub-nav-tab" role="tab" 
                                        aria-selected="false" data-target="add-class"
                                        id="tab-add-class" aria-controls="add-class">
                                    🏫 เพิ่มชั้นเรียน
                                </button>
                            </li>
                            <li role="none">
                                <button type="button" class="data-sub-nav-tab" role="tab" 
                                        aria-selected="false" data-target="add-room"
                                        id="tab-add-room" aria-controls="add-room">
                                    🏠 เพิ่มห้องเรียน
                                </button>
                            </li>
                            <li role="none">
                                <button type="button" class="data-sub-nav-tab" role="tab" 
                                        aria-selected="false" data-target="add-subject"
                                        id="tab-add-subject" aria-controls="add-subject">
                                    📚 เพิ่มวิชาเรียน
                                </button>
                            </li>
                        </ul>
                    </nav>
                    
                    <div class="admin-forms-grid">
                        <!-- Add Teacher Tab -->
                        <div id="add-teacher" class="data-sub-page active" role="tabpanel" 
                             aria-labelledby="tab-add-teacher">
                            <div class="admin-form-section">
                                <h3>👨‍🏫 เพิ่มครู</h3>
                                <form id="teacher-form" class="admin-form">
                                    <div class="form-group">
                                        <label for="teacher-name">ชื่อ:</label>
                                        <input type="text" id="teacher-name" name="name" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="teacher-subject-group">กลุ่มสาระ:</label>
                                        <select id="teacher-subject-group" name="subject_group" required>
                                            <option value="">-- เลือกกลุ่มสาระ --</option>
                                            <option value="วิทยาศาสตร์">วิทยาศาสตร์</option>
                                            <option value="คณิตศาสตร์">คณิตศาสตร์</option>
                                            <option value="ภาษาไทย">ภาษาไทय</option>
                                            <option value="ภาษาอังกฤษ">ภาษาอังกฤษ</option>
                                            <option value="สังคมศึกษา">สังคมศึกษา</option>
                                            <option value="ศิลปะ">ศิลปะ</option>
                                            <option value="พลศึกษา">พลศึกษา</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="teacher-phone">เบอร์โทร:</label>
                                        <input type="tel" id="teacher-phone" name="phone">
                                    </div>
                                    <div class="form-group">
                                        <label for="teacher-email">อีเมล:</label>
                                        <input type="email" id="teacher-email" name="email">
                                    </div>
                                    <button type="submit" class="btn btn--primary">💾 บันทึก</button>
                                </form>
                            </div>
                        </div>

                        <!-- Add Class Tab -->
                        <div id="add-class" class="data-sub-page hidden" role="tabpanel" 
                             aria-labelledby="tab-add-class">
                            <div class="admin-form-section">
                                <h3>🏫 เพิ่มชั้นเรียน</h3>
                                <form id="class-form" class="admin-form">
                                    <div class="form-group">
                                        <label for="class-grade">ชั้น:</label>
                                        <select id="class-grade" name="grade_level" required>
                                            <option value="">-- เลือกชั้น --</option>
                                            <option value="ม.1">ม.1</option>
                                            <option value="ม.2">ม.2</option>
                                            <option value="ม.3">ม.3</option>
                                            <option value="ม.4">ม.4</option>
                                            <option value="ม.5">ม.5</option>
                                            <option value="ม.6">ม.6</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="class-section">ห้อง:</label>
                                        <input type="number" id="class-section" name="section" min="1" max="20" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="class-student-count">จำนวนนักเรียน:</label>
                                        <input type="number" id="class-student-count" name="student_count" min="1" max="50">
                                    </div>
                                    <button type="submit" class="btn btn--primary">💾 บันทึก</button>
                                </form>
                            </div>
                        </div>

                        <!-- Add Room Tab -->
                        <div id="add-room" class="data-sub-page hidden" role="tabpanel" 
                             aria-labelledby="tab-add-room">
                            <div class="admin-form-section">
                                <h3>🏠 เพิ่มห้องเรียน</h3>
                                <form id="room-form" class="admin-form">
                                    <div class="form-group">
                                        <label for="room-name">ชื่อห้อง:</label>
                                        <input type="text" id="room-name" name="name" required placeholder="เช่น 401, เทค-1, แล็บฟิสิกส์">
                                    </div>
                                    <div class="form-group">
                                        <label for="room-type">ประเภทห้อง:</label>
                                        <select id="room-type" name="room_type" required>
                                            <option value="">-- เลือกประเภท --</option>
                                            <option value="CLASS">ห้องเรียนทั่วไป</option>
                                            <option value="TECH">ห้องเทคโนโลยี</option>
                                            <option value="LAB_SCI">ห้องปฏิบัติการวิทยาศาสตร์</option>
                                            <option value="LAB_COMP">ห้องคอมพิวเตอร์</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="room-capacity">ความจุ:</label>
                                        <input type="number" id="room-capacity" name="capacity" min="1" max="100">
                                    </div>
                                    <button type="submit" class="btn btn--primary">💾 บันทึก</button>
                                </form>
                            </div>
                        </div>

                        <!-- Add Subject Tab -->
                        <div id="add-subject" class="data-sub-page hidden" role="tabpanel" 
                             aria-labelledby="tab-add-subject">
                            <div class="admin-form-section">
                                <h3>📚 เพิ่มวิชาเรียน</h3>
                                <form id="subject-form" class="admin-form">
                                    <div class="form-group">
                                        <label for="subject-teacher">ครู:</label>
                                        <select id="subject-teacher" name="teacher_id" required>
                                            <option value="">-- เลือกครู --</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="subject-class">ห้องเรียน:</label>
                                        <select id="subject-class" name="class_id" required>
                                            <option value="">-- เลือกห้องเรียน --</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="subject-name">วิชา:</label>
                                        <input type="text" id="subject-name" name="subject_name" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="subject-code">รหัสวิชา:</label>
                                        <input type="text" id="subject-code" name="subject_code">
                                    </div>
                                    <div class="form-group">
                                        <label for="subject-periods">คาบ/สัปดาห์:</label>
                                        <input type="number" id="subject-periods" name="periods_per_week" min="1" max="10" required>
                                    </div>
                                    <div class="form-group">
                                        <label>
                                            <input type="checkbox" id="subject-requires-room" name="requires_room">
                                            ต้องใช้ห้องพิเศษ
                                        </label>
                                    </div>
                                    <div class="form-group hidden" id="subject-room-type-group">
                                        <label for="subject-room-type">ประเภทห้องที่ต้องการ:</label>
                                        <select id="subject-room-type" name="required_room_type">
                                            <option value="TECH">ห้องเทคโนโลยี</option>
                                            <option value="LAB_SCI">ห้องปฏิบัติการวิทยาศาสตร์</option>
                                            <option value="LAB_COMP">ห้องคอมพิวเตอร์</option>
                                        </select>
                                    </div>
                                    <button type="submit" class="btn btn--primary">💾 บันทึก</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Other Admin Tabs -->
                <div id="admin-schedule" class="sub-page hidden admin-section" role="tabpanel" 
                     aria-labelledby="tab-admin-schedule">
                    <div class="ai-generation-container">
                        <h3>🤖 สร้างตารางสอน</h3>
                        <div class="generation-controls">
                            <button type="button" class="btn btn--primary" id="btn-generate-ai">🎯 Generate ตารางด้วย AI</button>
                            <button type="button" class="btn btn--outline" id="btn-preview-schedule">📋 Preview ตาราง</button>
                            <button type="button" class="btn btn--outline" id="btn-edit-schedule">✏️ แก้ไขตาราง</button>
                            <button type="button" class="btn btn--success" id="btn-save-schedule">💾 บันทึกเข้า Database</button>
                        </div>
                        <div id="schedule-preview" class="schedule-preview hidden">
                            <!-- Generated schedule preview will appear here -->
                        </div>
                    </div>
                </div>

                <div id="admin-substitute" class="sub-page hidden admin-section" role="tabpanel" 
                     aria-labelledby="tab-admin-substitute">
                    <div class="substitute-management-container">
                        <h3>🔄 จัดการการสอนแทน</h3>
                        <div class="substitute-form">
                            <div class="form-group">
                                <label for="substitute-date">วันที่:</label>
                                <input type="date" id="substitute-date" name="date" required>
                            </div>
                            <div class="form-group">
                                <label>ครูที่ไม่อยู่:</label>
                                <div id="absent-teachers-checklist" class="checklist">
                                    <!-- Absent teachers checklist will be rendered here -->
                                </div>
                            </div>
                            <div class="substitute-actions">
                                <button type="button" class="btn btn--primary" id="btn-find-substitutes">🧮 หาครูสอนแทน</button>
                                <button type="button" class="btn btn--success" id="btn-submit-substitutes">💾 Submit การสอนแทน</button>
                            </div>
                        </div>
                        <div id="substitute-recommendations" class="recommendations hidden">
                            <!-- Substitute recommendations will appear here -->
                        </div>
                    </div>
                </div>

                <div id="admin-year" class="sub-page hidden admin-section" role="tabpanel" 
                     aria-labelledby="tab-admin-year">
                    <div class="year-management-container">
                        <h3>📅 จัดการปีการศึกษา</h3>
                        <div class="year-actions">
                            <button type="button" class="btn btn--primary" id="btn-create-year">สร้างปีการศึกษาใหม่</button>
                            <button type="button" class="btn btn--outline" id="btn-clone-year">คัดลอกข้อมูลจากปีที่แล้ว</button>
                            <button type="button" class="btn btn--outline" id="btn-migrate-data">ย้ายข้อมูล</button>
                        </div>
                        <div id="year-operations" class="operations-area">
                            <!-- Year management operations will appear here -->
                        </div>
                    </div>
                </div>

                <!-- Admin Loading/Error States -->
                <div id="admin-loading" class="loading-state hidden" aria-live="polite">
                    <div class="loading-spinner"></div>
                    <p>กำลังดำเนินการ...</p>
                </div>
                
                <div id="admin-error" class="error-state hidden" role="alert">
                    <p class="error-message">เกิดข้อผิดพลาดในการดำเนินการ</p>
                    <button type="button" class="btn btn--primary" id="admin-retry">ลองใหม่</button>
                </div>
            </section>

        </div>
    </main>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="container">
            <p>&copy; 2025 ระบบจัดตารางสอน - โรงเรียนปากท่อพิทยาคม จ.ราชบุรี</p>
            <p>พัฒนาโดย Cat-Meow-PTK</p>
        </div>
    </footer>

    <!-- Global Notification System -->
    <div id="notification-container" class="notification-container" aria-live="polite">
        <!-- Toast notifications will appear here -->
    </div>

    <!-- Loading Overlay -->
    <div id="global-loading" class="loading-overlay hidden" aria-hidden="true">
        <div class="loading-spinner-large"></div>
        <p>กำลังโหลด...</p>
    </div>

    <!-- JavaScript Modules (single entry point) -->
    <script type="module" src="js/app.js"></script>

</body>
</html>
